<!DOCTYPE html>
<html>
<head>
    <title>Test Supabase Connection</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Testing Supabase Connection</h1>
    <div id="output"></div>
    
    <script>
        const SUPABASE_URL = 'https://tbvjpjoqlsinlkoopnwg.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRidmpwam9xbHNpbmxrb29wbndnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEyMDU0MTcsImV4cCI6MjA2Njc4MTQxN30.DKCEuwT_8u5-LasNJQX0vRmlASwYe1TPwHkbbt60hmA';
        
        const { createClient } = supabase;
        const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        const output = document.getElementById('output');
        
        async function testConnection() {
            output.innerHTML = 'Testing connection...<br>';
            
            try {
                // Test 1: Basic count query for quests
                const { data: questsCount, error: questsError, count } = await supabaseClient
                    .from('quests')
                    .select('id', { count: 'exact', head: true });
                    
                if (questsError) {
                    output.innerHTML += `❌ Quests query failed: ${questsError.message}<br>`;
                } else {
                    output.innerHTML += `✅ Quests count: ${count}<br>`;
                }
                
                // Test 2: Profiles query
                const { data: profilesData, error: profilesError } = await supabaseClient
                    .from('profiles')
                    .select('*')
                    .limit(1);
                    
                if (profilesError) {
                    output.innerHTML += `❌ Profiles query failed: ${profilesError.message}<br>`;
                } else {
                    output.innerHTML += `✅ Profiles query success: ${profilesData.length} records<br>`;
                }
                
                // Test 3: Cities query
                const { data: citiesData, error: citiesError } = await supabaseClient
                    .from('cities')
                    .select('*')
                    .limit(1);
                    
                if (citiesError) {
                    output.innerHTML += `❌ Cities query failed: ${citiesError.message}<br>`;
                } else {
                    output.innerHTML += `✅ Cities query success: ${citiesData.length} records<br>`;
                }
                
                // Test 4: User quest progress query
                const { data: progressData, error: progressError } = await supabaseClient
                    .from('user_quest_progress')
                    .select('*')
                    .limit(1);
                    
                if (progressError) {
                    output.innerHTML += `❌ User progress query failed: ${progressError.message}<br>`;
                } else {
                    output.innerHTML += `✅ User progress query success: ${progressData.length} records<br>`;
                }
                
                output.innerHTML += '<br>All tests completed!';
                
            } catch (error) {
                output.innerHTML += `❌ Unexpected error: ${error.message}<br>`;
            }
        }
        
        testConnection();
    </script>
</body>
</html>